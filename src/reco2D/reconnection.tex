%%%%%%%%%%%%%%%%%%%%%definitions%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{../../doc/related_pages/header.tex}
\input{../../doc/related_pages/newcommands.tex}

\renewcommand{\ne}{\ensuremath{n }}
\newcommand{\Ni}{\ensuremath{N}}
\newcommand{\ue}{\ensuremath{u_\parallel}}
\newcommand{\Ui}{\ensuremath{U_\parallel}}
\newcommand{\Apar}{\ensuremath{A_\parallel}}
\newcommand{\neref}{\ensuremath{n_0}}
\newcommand{\Teref}{\ensuremath{T_{e0}}} %\rhoN

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%DOCUMENT%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\title{Collisionless Reconnection}
\author{ M.~Held and M.~Wiesenberger}
\maketitle

\begin{abstract}
\end{abstract}

\section{Equations}
%tearing instability <-> reconnection
Collisionless reconnection was studied in~\cite{stanier15}, gyro-fluid and gyro-kinetic studies~\cite{comisso13,zacharias14}. drift fluid-kinetic model~\cite{loureiro13}.
Our reduced model is based on a recent formulation of a full-F gyro-fluid model~\cite{Madsen2013}.
It consists of the first two moment equations for electrons and ions
\begin{align}
%%%
\frac{\partial}{\partial t} \ne =&
 - \left[\phi, \ne\right]
+ \left[\Apar,\ne \ue  \right]
-\nu_\perp \Delta_\perp^2\ne
\\
%%%
\label{firstgyromom}
\frac{\partial}{\partial t} \Ni =&
 - \left[\psi, \Ni\right]
+ \left[\Gamma_1 \Apar ,\Ni \Ui  \right]
-\nu_\perp \Delta_\perp^2\Ni
 \\
 %%%
\frac{\partial}{\partial t} \left( \ue+ \frac{1}{\mu_e} \Apar \right) =&
      -  \left[ \psi, \ue+ \frac{1}{\mu_e} \Apar  \right]% \nonumber \\
    +   \left[\Apar,\ue^2/2   \right]% \nonumber \\
      - \frac{1}{\mu_e}  \left[\Apar,\ln{\ne}   \right]
    -\nu_\perp \Delta_\perp^2\ue
      \\
      \frac{\partial}{\partial t} \left( \Ui+ \Gamma_1 \Apar  \right) =&
      -  \left[ \psi, \Ui+ \Gamma_1 \Apar  \right]% \nonumber \\
     +   \left[\Gamma_1 \Apar,\Ui^2/2   \right]% \nonumber \\
      + \tau_i  \left[\Gamma_1 \Apar,\ln{\Ni}   \right]
    -\nu_\perp \Delta_\perp^2\Ui
\end{align}
which are coupled by polarisation and induction
\begin{align}
 \ne - \Gamma_1 \Ni &= \vec{\nabla}\cdot\left(\Ni \vec{\nabla}_\perp \phi\right) \\
 \frac{1}{\beta} \vec{\nabla}_\perp^2 \Apar &=  \ne \ue - \Gamma_1 (\Ni \Ui)
\end{align}
with gyro-averaged parallel electromagnetic vector potential, generalized electric potential and gyro-averaging operator
\begin{align}
 \psi &:= \Gamma_1 \phi - u_E^2 /2  \\
  \Gamma_1 &:= (1-\frac{\tau_i}{2} \vec{\nabla}_\perp^2 )^{-1} 
\end{align}
and ion gyro-radius, vacuum permeability and ion gyrofrequency
\begin{align}
  \rho_{i}     &:= \frac{\sqrt{T_{i} m_i}}{e B} \\
  \mu_0 &:= 1/(\epsilon_0 c^2) \\
  \Omega_i &:= e B / m_i
\end{align}
After exploiting the gyro-Bohm normalisation, our model is controlled by the dimensionless parameters. These
are the
\begin{align}
 \mu   &:=  \frac{m}{Z m_i} \\ 
 \tau  &:=  \frac{T}{ Z T_i}\\
 \beta_{e0} &:=  \frac{\mu_0 \neref \Teref }{ B_0^2 }
\end{align}
These parameters are related to the conventional MHD normalisation (e.g.~\cite{comisso13,zacharias14}) according to
\begin{align}
 \hat{d}_i &= \frac{\hat{\rho}_{s}}{\sqrt{\beta_{e0}}} \\
 \hat{d}_e &= \hat{d}_i \sqrt{|\mu_e|} \\
 \hat{\rho}_{i} &:= \frac{ \hat{\rho}_{s}}{\sqrt{\tau}}\\
 \hat{\rho}_{s} &:= \frac{\rho_{s}}{L}
\end{align}
Here, \(\hat{d}_i:=d_i/L=c/(\omega_{p,i} L)\) is the normalised ion skin depth, \(\hat{d}_e:=d_e/L=c/(\omega_{p,e} L)\) is the normalised electron skin depth, 
\(\hat{\rho}_{i}:=\rho_i/L\) is the normalised ion gyro-radius and \(\hat{\rho}_{s}\) is the normalised length scale.
\\


\section{Initial and boundary conditions}
The boundary conditions for all variables are Dirichlet in $x$.
The $y$-direction is periodic.

We initialize
\begin{align}
 \Ni&=\ne=\neref \\
 \phi &= 0 \\
  \Ui&=0 \\
  \ue &= \frac{1}{\ne \beta }\vec{\nabla}^2_{\perp} \Apar
\end{align}
where we can choose $A_\parallel$.
\subsection{Harris sheet}
The initial parallel magnetic vector potential is
\begin{align}
    \Apar =\left( A_0 / \cosh{( 4  \pi x / L_x )}^2 +A_1\cos{(2 \pi y/L_y)}\right) \cos( \pi x /L_x)
\end{align}
\subsection{Island}
The initial parallel magnetic vector potential is
\begin{align}
    \Apar =\left[ \frac{L_x}{4\pi} \ln \left\{ \cosh( 4\pi x/L_x) + \varepsilon \cos( 4\pi y/L_x)\right\} + A_1\cos{(2 \pi y/L_y)}\right] \cos( \pi x /L_x)
\end{align}
with $\varepsilon = 0.2$.

\section{Invariants}
The mass density and diffusions are
\begin{align}
    \mathcal M &= n-1 \\
     \Lambda_n &= -\nu_\perp \Delta_\perp^2 n  \\
\end{align}
The inherent energy density of our system is:
\begin{align}
 \mathcal{E} := &
                    \ne \ln{(\ne)}
                  + \tau_i \Ni \ln{( \Ni)}
                  \nonumber \\
                 &- \frac{1}{2} \mu_e \ne \ue^2
                  + \frac{1}{2} \Ni \Ui^2
                  \nonumber \\
                 &+\frac{1}{2} \Ni u_E^2
                  + \frac{|\nabla_\perp \Apar|^2}{2 \beta}
\end{align}
The energy diffusion is
\begin{align}
    \Lambda_\mathcal{E} :=  &\left( (1+\ln \ne) + \frac{1}{2} z_e \mu_e \ue^2 - \phi \right) (-\nu_\perp \Delta_\perp^2 \ne)
    \nonumber\\
    &+ \left( \tau_i ( 1+\ln \Ni) + \frac{1}{2} \Ui^2 + \psi_i\right)(-\nu_\perp \Delta_\perp^2 \Ni)
    \nonumber\\
    &+ z_e\mu_e \ue\ne (-\nu_\perp \Delta_\perp^2 \ue)
    \nonumber\\
    &+ \Ui\Ni (-\nu_\perp \Delta_\perp^2 \Ui)
\end{align}

\section{Reconnection rate}
 A consistent definition of the reconnection rate is not trivial~\cite{comisso16}.
 We adopt a similar definiton as in Ref.~\cite{comisso13}
\begin{align}
 Q_X&:=|  \Apar(\vec{x}_X, 0)-\Apar(\vec{x}_X,t) | \\
 \gamma&:= \frac{\d \ln{(Q_X)}}{\d t}
\end{align}
where $\vec{x}_X = [0,0]$.
This can be easily evaluated in post-processing using a python script.

\section{Numerical methods}
discontinuous Galerkin on structured grid
\rowcolors{2}{gray!25}{white} %%% Use this line in front of longtable
\begin{longtable}{ll>{\RaggedRight}p{7cm}}
\toprule
\rowcolor{gray!50}\textbf{Term} &  \textbf{Method} & \textbf{Description}  \\ \midrule
coordinate system & Cartesian 2D & equidistant discretization of $[0,l_x] \times [0,l_y]$, equal number of Gaussian nodes in x and y \\
matrix inversions & conjugate gradient & Use previous two solutions to extrapolate initial guess and $1/\chi$ as preconditioner \\
\ExB advection & Arakawa & s.a. \cite{Einkemmer2014} \\
curvature terms & direct & flux conserving \\
time &  Karniadakis multistep & $3rd$ order explicit, diffusion $2nd$ order implicit \\
\bottomrule
\end{longtable}

%..................................................................
\bibliography{../../doc/related_pages/references}
\end{document}
